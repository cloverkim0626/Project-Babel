import{c as g,u as v,r as l,j as e,s as r}from"./index-Dk9nG0GJ.js";import{S as N}from"./shield-DlIsibMa.js";import{L as k}from"./lock-BwzEVVz7.js";import{A as S}from"./arrow-right-A5A9sfVa.js";const E=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],I=g("circle-alert",E);const C=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],A=g("mail",C);function D(){const i=v(),[o,h]=l.useState(""),[m,f]=l.useState(""),[n,c]=l.useState(!1),[b,x]=l.useState(null),[d,p]=l.useState("signin"),w=async t=>{t.preventDefault(),c(!0),x(null);try{if(d==="signup"){const{error:s}=await r.auth.signUp({email:o,password:m,options:{data:{nickname:o.split("@")[0],class_type:"Challenger"}}});if(s)throw s;alert("Sign up successful! You can now log in."),p("signin")}else{const{data:{session:s},error:a}=await r.auth.signInWithPassword({email:o,password:m});if(a)throw a;if(s?.user){const{data:u}=await r.from("users").select("role").eq("id",s.user.id).single();u?.role==="master"||u?.role==="admin"?i("/admin"):i("/dashboard")}}}catch(s){x(s.message)}finally{c(!1)}},y=async()=>{c(!0);const t="student@babel.com",s="password123";try{const{error:a}=await r.auth.signInWithPassword({email:t,password:s});if(a){console.log("Demo account not found, creating...");const{error:u}=await r.auth.signUp({email:t,password:s,options:{data:{nickname:"Demo Student",class_type:"Challenger"}}});if(u)throw new Error("Demo creation failed. Please disable 'Confirm Email' in Supabase!");const{error:j}=await r.auth.signInWithPassword({email:t,password:s});if(j){alert("User created but email not confirmed. Go to Supabase -> Auth -> Providers -> Email -> Disable 'Confirm Email'.");return}i("/dashboard")}else i("/dashboard")}catch(a){x(a.message)}finally{c(!1)}};return e.jsxs("div",{className:"min-h-screen bg-obsidian flex items-center justify-center p-4 font-mono text-paper relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-purple-900/10 via-black to-black -z-10"}),e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"linear-gradient(#333 1px, transparent 1px), linear-gradient(90deg, #333 1px, transparent 1px)",backgroundSize:"40px 40px"}}),e.jsxs("div",{className:"w-full max-w-md bg-black/60 backdrop-blur-md border border-white/10 p-8 rounded-2xl shadow-2xl relative",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-babel-gold/10 rounded-full flex items-center justify-center mx-auto mb-4 border border-babel-gold/30",children:e.jsx(N,{className:"text-babel-gold w-8 h-8"})}),e.jsx("h1",{className:"text-3xl font-serif text-white mb-2 tracking-wide",children:"BABEL SYSTEM"}),e.jsx("p",{className:"text-xs text-stone-500 uppercase tracking-widest",children:"Identify Yourself"})]}),e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-widest text-stone-500 ml-1",children:"Access ID"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-stone-600",size:16}),e.jsx("input",{type:"email",value:o,onChange:t=>h(t.target.value),className:"w-full bg-black/50 border border-white/10 rounded-lg py-3 pl-10 pr-4 text-white focus:border-babel-gold focus:ring-1 focus:ring-babel-gold outline-none transition-all",placeholder:"name@example.com",required:!0})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs uppercase tracking-widest text-stone-500 ml-1",children:"Passcode"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-stone-600",size:16}),e.jsx("input",{type:"password",value:m,onChange:t=>f(t.target.value),className:"w-full bg-black/50 border border-white/10 rounded-lg py-3 pl-10 pr-4 text-white focus:border-babel-gold focus:ring-1 focus:ring-babel-gold outline-none transition-all",placeholder:"••••••••",required:!0})]})]}),b&&e.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-xs bg-red-900/20 p-3 rounded border border-red-500/30",children:[e.jsx(I,{size:14}),b]}),e.jsxs("button",{type:"submit",disabled:n,className:"w-full bg-babel-gold text-black font-bold py-3 rounded-lg hover:bg-yellow-500 transition-all transform hover:scale-[1.02] flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[n?"Processing...":d==="signin"?"Initialize Link":"Register Identity",!n&&e.jsx(S,{size:16})]})]}),e.jsxs("div",{className:"mt-6 flex flex-col gap-3",children:[e.jsx("button",{onClick:()=>y(),disabled:n,className:"w-full bg-white/5 text-stone-400 text-xs py-3 rounded-lg hover:bg-white/10 transition-colors border border-white/5",children:"Use Demo Account (Guest)"}),e.jsxs("div",{className:"relative py-2",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-white/10"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-black px-2 text-stone-600",children:"Or"})})]}),e.jsx("button",{onClick:()=>p(d==="signin"?"signup":"signin"),className:"w-full text-stone-500 hover:text-babel-gold text-xs transition-colors uppercase tracking-widest",children:d==="signin"?"Create New Identity":"Return to Login"})]})]})]})}export{D as default};
