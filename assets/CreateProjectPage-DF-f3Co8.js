import{c as W,u as J,r as s,j as e}from"./index-CxDURwdF.js";import{a as Y,L as w,G as V,c as M}from"./ContinentManager-D2hn9vEO.js";import{A as q}from"./arrow-left-CDGCNdZG.js";import{B as Q}from"./book-open-HbqM0iWU.js";import"./globe-D88iF9za.js";import"./circle-alert-DdIaksX2.js";import"./x-CSBxUgK7.js";const Z=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],ee=W("archive",Z),_=["공통영어1","공통영어2","영어1","영어2","심화영어"],te=Array.from({length:7},(p,a)=>String(2020+a)),se=["3월","6월","9월","10월","대수능"];function xe(){const p=J(),[a,$]=s.useState(""),[g,N]=s.useState(!1),[B,n]=s.useState(""),[y,H]=s.useState(null),[o,R]=s.useState("TEXTBOOK"),[i,z]=s.useState(_[0]),[c,A]=s.useState(""),[d,U]=s.useState("2024"),[l,L]=s.useState("High 1"),[x,X]=s.useState("3월"),[b,D]=s.useState(""),[m,I]=s.useState(""),[f,G]=s.useState("");s.useEffect(()=>{},[o,i,c,d,l,x,b]);const k=()=>o==="TEXTBOOK"?`${i} - ${c}`:o==="MOCK"?`${d}년 ${x} 고${l==="High 1"?1:l==="High 2"?2:3} 모의고사`:o==="OTHER"?`${b} ${f} (${m})`:a,F=async()=>{if(a.trim()){N(!0),n("Initializing Manual Auth...");try{const t="https://fdopvjopmmoadhoefkcf.supabase.co",O="sb_publishable_NT2tJi14GBr8Uh3I9SDROg_zM_v5KTi";let C="";try{C=t.split("//")[1].split(".")[0]}catch(r){console.error("URL Parsing failed",r)}let S=`sb-${C}-auth-token`,j=localStorage.getItem(S);if(!j){console.warn("[CreatePage] Exact key not found:",S);const v=Object.keys(localStorage).find(K=>K.startsWith("sb-")&&K.endsWith("-auth-token"));if(v)console.log("[CreatePage] Found fallback key:",v),j=localStorage.getItem(v);else throw new Error("브라우저에 저장된 로그인 정보가 없습니다. (No Token Found)")}const T=JSON.parse(j||"{}").access_token;if(!T)throw new Error("토큰을 찾을 수 없습니다. 다시 로그인해주세요.");n("Constructing Metadata...");const E={category:o,textbook:o==="TEXTBOOK"?{subject:i,unit:c}:null,mock:o==="MOCK"?{year:d,month:x,grade:l}:null,other:o==="OTHER"?{workbook:b,publisher:m,unit:f}:null},P=k()||a;console.log("[CreatePage] Payload:",{name:a,finalDisplayName:P,metadata:E});const h=await fetch(`${t}/rest/v1/continents`,{method:"POST",headers:{apikey:O,Authorization:`Bearer ${T}`,"Content-Type":"application/json",Prefer:"return=representation"},body:JSON.stringify({name:a,display_name:P,theme_color:"#D4AF37",metadata:E})});if(!h.ok){const r=await h.text();throw new Error(`HTTP ${h.status}: ${r}`)}const u=await h.json();console.log("[CreatePage] Success:",u),n("Success! Starting Workflow..."),setTimeout(()=>{const r=Array.isArray(u)?u[0]:u;H(r)},500)}catch(t){console.error("[CreatePage] Error:",t),n(`Error: ${t.message}`),alert(`오류 발생: ${t.message}`)}finally{N(!1)}}};return y?e.jsx("div",{className:"fixed inset-0 z-50 bg-stone-950",children:e.jsx(Y,{continent:y,initialView:"add",onClose:()=>p("/admin")})}):e.jsx("div",{className:"min-h-screen bg-stone-950 flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-2xl bg-stone-900 border border-white/10 rounded-2xl p-8 shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-babel-gold/5 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2 pointer-events-none"}),e.jsxs("button",{onClick:()=>p("/admin"),className:"flex items-center gap-2 text-stone-500 hover:text-white mb-8 text-sm transition-colors",children:[e.jsx(q,{size:16})," 취소하고 돌아가기"]}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"p-4 bg-babel-gold/10 rounded-xl text-babel-gold border border-babel-gold/20",children:e.jsx(w,{size:32})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-serif text-white mb-1",children:"Create New Project"}),e.jsx("p",{className:"text-stone-400 text-sm",children:"새로운 학습 프로젝트를 생성합니다. (Safe Mode Active)"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs uppercase tracking-widest text-stone-500 mb-2 font-bold",children:"Folder Name (Internal)"}),e.jsx("input",{value:a,onChange:t=>$(t.target.value),className:"w-full bg-black border border-white/20 rounded-lg p-4 text-white font-mono focus:border-babel-gold outline-none focus:ring-1 focus:ring-babel-gold/50 transition-all placeholder:text-stone-700",placeholder:"ex: 2024-Regular-Spring",autoFocus:!0}),e.jsx("p",{className:"text-[10px] text-stone-600 mt-1",children:" URL 및 내부 식별용 영문 이름"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs uppercase tracking-widest text-stone-500 mb-2 font-bold",children:"Category"}),e.jsx("div",{className:"grid grid-cols-3 gap-2",children:["TEXTBOOK","MOCK","OTHER"].map(t=>e.jsxs("button",{type:"button",onClick:()=>R(t),className:`py-3 rounded-lg border text-sm font-bold transition-all flex flex-col items-center gap-1 ${o===t?"bg-babel-gold text-black border-babel-gold shadow-[0_0_15px_rgba(212,175,55,0.3)]":"bg-stone-800 text-stone-400 border-white/5 hover:bg-stone-700"}`,children:[t==="TEXTBOOK"&&e.jsx(Q,{size:14}),t==="MOCK"&&e.jsx(V,{size:14}),t==="OTHER"&&e.jsx(ee,{size:14}),t==="TEXTBOOK"&&"교과서",t==="MOCK"&&"모의고사",t==="OTHER"&&"기타"]},t))})]}),e.jsxs("div",{className:"bg-black/40 p-5 rounded-xl border border-white/10 animate-in fade-in slide-in-from-top-2",children:[o==="TEXTBOOK"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase text-stone-500 mb-1",children:"과목 선택"}),e.jsx("select",{value:i,onChange:t=>z(t.target.value),className:"w-full bg-stone-900 border border-white/10 rounded p-2 text-white outline-none focus:border-babel-gold",children:_.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase text-stone-500 mb-1",children:"단원 (Unit)"}),e.jsx("input",{type:"text",placeholder:"예: Lesson 1",value:c,onChange:t=>A(t.target.value),className:"w-full bg-stone-900 border border-white/10 rounded p-2 text-white outline-none focus:border-babel-gold"})]})]}),o==="MOCK"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase text-stone-500 mb-1",children:"연도 (Year)"}),e.jsx("select",{value:d,onChange:t=>U(t.target.value),className:"w-full bg-stone-900 border border-white/10 rounded p-2 text-white outline-none focus:border-babel-gold",children:te.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase text-stone-500 mb-1",children:"학년 (Grade)"}),e.jsxs("select",{value:l,onChange:t=>L(t.target.value),className:"w-full bg-stone-900 border border-white/10 rounded p-2 text-white outline-none focus:border-babel-gold",children:[e.jsx("option",{value:"High 1",children:"고1"}),e.jsx("option",{value:"High 2",children:"고2"}),e.jsx("option",{value:"High 3",children:"고3"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase text-stone-500 mb-1",children:"시행월 (Month)"}),e.jsx("div",{className:"flex gap-2",children:se.map(t=>e.jsx("button",{type:"button",onClick:()=>X(t),className:`flex-1 py-2 text-xs rounded border transition-colors ${x===t?"bg-stone-700 text-white border-babel-gold":"bg-stone-800 text-stone-500 border-transparent hover:bg-stone-700"}`,children:t},t))})]})]}),o==="OTHER"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase text-stone-500 mb-1",children:"문제집 종류"}),e.jsx("input",{type:"text",placeholder:"예: 수능특강",value:b,onChange:t=>D(t.target.value),className:"w-full bg-stone-900 border border-white/10 rounded p-2 text-white outline-none focus:border-babel-gold"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase text-stone-500 mb-1",children:"출판사"}),e.jsx("input",{type:"text",placeholder:"예: EBS",value:m,onChange:t=>I(t.target.value),className:"w-full bg-stone-900 border border-white/10 rounded p-2 text-white outline-none focus:border-babel-gold"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] uppercase text-stone-500 mb-1",children:"단원"}),e.jsx("input",{type:"text",placeholder:"예: 01",value:f,onChange:t=>G(t.target.value),className:"w-full bg-stone-900 border border-white/10 rounded p-2 text-white outline-none focus:border-babel-gold"})]})]})]})]})]}),e.jsxs("div",{className:"flex flex-col h-full justify-between",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs uppercase tracking-widest text-stone-500 mb-2 font-bold",children:"Preview Card"}),e.jsxs("div",{className:"bg-black border border-white/10 rounded-xl p-0 hover:border-babel-gold transition-all group relative overflow-hidden h-48 flex flex-col shadow-2xl",children:[e.jsx("div",{className:"h-24 bg-stone-900 border-b border-white/5 relative overflow-hidden flex items-center justify-center",children:e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-stone-800 to-black flex items-center justify-center",children:e.jsx(w,{size:32,className:"text-white/10"})})}),e.jsxs("div",{className:"p-4 flex-1 flex flex-col justify-between bg-stone-900/50",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-white font-serif font-bold text-lg mb-1 truncate text-babel-gold",children:k()||"Display Name"}),e.jsx("p",{className:"text-xs text-stone-500 font-mono truncate",children:a||"folder-name"})]}),e.jsx("div",{className:"flex items-center justify-between pt-2 border-t border-white/5 text-[10px] text-stone-400 uppercase tracking-wider",children:e.jsx("span",{children:"Preview Only"})})]})]}),e.jsxs("div",{className:"mt-8 p-4 bg-yellow-500/5 border border-yellow-500/20 rounded-lg",children:[e.jsxs("h4",{className:"text-babel-gold text-xs font-bold mb-1 flex items-center gap-2",children:[e.jsx(M,{size:12,className:g?"animate-spin":"opacity-0"}),"System Status"]}),e.jsx("p",{className:"text-stone-400 text-xs font-mono h-4",children:B||"Ready to create."})]})]}),e.jsx("div",{className:"mt-auto pt-8",children:e.jsxs("button",{onClick:F,disabled:g||!a.trim(),className:"w-full bg-babel-gold text-black font-bold py-4 rounded-xl hover:bg-yellow-500 disabled:opacity-50 disabled:cursor-not-allowed flex justify-center items-center gap-2 shadow-[0_0_20px_rgba(212,175,55,0.2)] transition-all transform active:scale-95 text-lg",children:[g?e.jsx(M,{className:"animate-spin"}):e.jsx(w,{}),"Create Project"]})})]})]})]})})}export{xe as default};
