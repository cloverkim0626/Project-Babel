import{c as _,r as f,u as E,j as t,b as m,C as T}from"./index-Dk9nG0GJ.js";import{u as A}from"./useGameEngine-eqpmmfD6.js";import{T as I,C as R}from"./trophy-BZsvmrwm.js";import{A as O}from"./arrow-left-BOSfvJXe.js";import{B as F}from"./book-open-DD1MmSGm.js";import{Z as q}from"./zap-2m9T0vxW.js";const L=[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]],H=_("skull",L),$=864e5,W=36e5,w=Symbol.for("constructDateFrom");function S(s,e){return typeof s=="function"?s(e):s&&typeof s=="object"&&w in s?s[w](e):s instanceof Date?new s.constructor(e):new Date(e)}function D(s,e){return S(s,s)}function k(s){const e=D(s),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+s-+n}function j(s,...e){const n=S.bind(null,e.find(o=>typeof o=="object"));return e.map(n)}function N(s,e){const n=D(s);return n.setHours(0,0,0,0),n}function P(s,e,n){const[o,a]=j(n?.in,s,e),i=N(o),l=N(a),d=+i-k(i),c=+l-k(l);return Math.round((d-c)/$)}function Y(s,e,n){const[o,a]=j(n?.in,s,e),i=y(o,a),l=Math.abs(P(o,a));o.setDate(o.getDate()-i*l);const d=+(y(o,a)===-i),c=i*(l-d);return c===0?0:c}function y(s,e){const n=s.getFullYear()-e.getFullYear()||s.getMonth()-e.getMonth()||s.getDate()-e.getDate()||s.getHours()-e.getHours()||s.getMinutes()-e.getMinutes()||s.getSeconds()-e.getSeconds()||s.getMilliseconds()-e.getMilliseconds();return n<0?-1:n>0?1:n}function B(s){return e=>{const o=(s?Math[s]:Math.trunc)(e);return o===0?0:o}}function C(s,e,n){const[o,a]=j(n?.in,s,e),i=(+o-+a)/W;return B(n?.roundingMethod)(i)}const V=s=>{const[e,n]=f.useState({timeLeft:"",isCorroded:!1,isWarning:!1,hoursRemaining:0});return f.useEffect(()=>{if(!s)return;const a=()=>{const l=new Date,d=new Date(s),c=C(d,l),b=Y(d,l),g=c<=24&&c>0,x=c<=0;let u="";x?u="CORRODED":b>0?u=`${b}d ${c%24}h`:u=`${c}h ${Math.max(0,60-l.getMinutes())}m`,n({timeLeft:u,isCorroded:x,isWarning:g,hoursRemaining:c})};a();const i=setInterval(a,6e4);return()=>clearInterval(i)},[s]),{...e,checkItemCorrosion:(a,i=24)=>{const l=new Date,d=new Date(a);return C(l,d)>=i}}},h=Array.from({length:8},(s,e)=>({id:`set-${e}`,index:e+1,status:e<2?"passed":e===2?"open":"locked",score:e<2?100:0})),J=()=>{const s=E(),{addXp:e,addPoints:n,logError:o}=A(),[a,i]=f.useState(!1),l=h.every(r=>r.status==="passed"),[d,c]=f.useState(!1);f.useEffect(()=>{if(l&&!d){const r=setTimeout(()=>{i(!0),c(!0),e(300),n(100)},500);return()=>clearTimeout(r)}},[l,d,e,n]);const b="Week 1: The Awakening",[g]=f.useState(()=>new Date(Date.now()+864e5*2).toISOString()),x=V(g),u=r=>{if(r.status==="locked"){alert("This sequence is sealed. Explain the previous grimoire first.");return}s(`/mission/${r.id}/play`)},M=()=>{o("Ephemeral"),alert("Mock Error Logged: 'Ephemeral' added to Ebbinghaus Vault (+1 min)")},z="/assets/party_splash.jpg";return t.jsxs("div",{className:"min-h-screen bg-obsidian text-paper font-mono flex flex-col relative overflow-hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-[url('https://images.unsplash.com/photo-1541701494587-cb58502866ab?q=80&w=2670&auto=format&fit=crop')] bg-cover bg-center opacity-30 pointer-events-none"}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-purple-950/80 via-black/60 to-black/90 pointer-events-none"}),a&&t.jsxs("div",{className:"absolute inset-0 z-50 bg-black/90 backdrop-blur-md flex flex-col items-center justify-center animate-in fade-in duration-1000",children:[t.jsx(I,{size:80,className:"text-babel-gold mb-6 animate-bounce"}),t.jsx("h1",{className:"text-5xl font-serif text-babel-gold font-bold mb-2 text-center text-shadow-gold",children:"ARCHIVE RESTORED"}),t.jsx("p",{className:"text-stone-300 tracking-widest uppercase mb-8",children:"All Sequences Stabilized"}),t.jsxs("div",{className:"text-center mb-8 animate-pulse text-babel-gold",children:["+300 XP Awarded",t.jsx("br",{}),"+100 Points Acquired"]}),t.jsx("div",{className:"flex gap-4",children:t.jsx("button",{onClick:()=>s("/world-map"),className:"px-8 py-3 bg-babel-gold text-obsidian font-bold rounded hover:scale-105 transition-transform",children:"Return to World Map"})})]}),t.jsxs("div",{className:"p-6 border-b border-white/10 flex items-center justify-between bg-black/60 backdrop-blur z-20 sticky top-0",children:[t.jsxs("button",{onClick:()=>s("/world-map"),className:"flex items-center gap-2 text-stone-400 hover:text-white transition-colors",children:[t.jsx(O,{size:16})," ",t.jsx("span",{className:"text-xs uppercase tracking-widest",children:"목록으로"})]}),t.jsx("div",{className:"text-center",children:t.jsxs("h2",{className:"text-xl font-serif text-babel-gold flex items-center justify-center gap-2 text-shadow-sm",children:[t.jsx(F,{size:18}),b]})}),t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx("button",{onClick:M,className:"p-2 border border-pain/30 text-pain rounded full hover:bg-pain hover:text-white transition-colors",title:"Simulate Wrong Answer",children:t.jsx(H,{size:14})}),t.jsxs("div",{className:m("flex items-center gap-2 text-xs border px-3 py-1 rounded",x.isWarning?"border-pain text-pain animate-pulse":"border-stone-700 text-stone-400"),children:[t.jsx(R,{size:14}),t.jsxs("span",{children:[x.timeLeft," 남음"]})]})]})]}),t.jsxs("div",{className:"flex-1 relative overflow-auto p-12 flex items-center justify-center",children:[t.jsx("div",{className:"absolute left-1/2 top-0 bottom-0 w-1 bg-white/5 -translate-x-1/2 hidden md:block"}),t.jsx("div",{className:"relative z-10 w-full max-w-4xl grid grid-cols-1 md:grid-cols-2 gap-12 md:gap-24",children:h.map((r,v)=>{const p=v%2===0;return t.jsxs("div",{className:m("flex flex-col relative",p?"md:items-end md:text-right":"md:items-start md:text-left","md:transform md:translate-y-12"),onClick:()=>u(r),children:[r.status==="open"&&t.jsxs("div",{className:m("absolute -top-20 z-20 w-20 h-20 animate-bounce transition-all duration-500",p?"right-2":"left-2"),children:[t.jsx("div",{className:"w-full h-full rounded-full border-2 border-babel-gold shadow-[0_0_20px_rgba(212,175,55,0.6)] overflow-hidden bg-black relative",children:t.jsx("img",{src:z,alt:"Coordinator",className:"w-[400%] max-w-none h-full object-cover",style:{objectPosition:"100% 20%"}})}),t.jsx("div",{className:"absolute -bottom-2 w-full text-center bg-black/80 text-[10px] text-babel-gold border border-babel-gold/50 rounded px-1 font-bold tracking-wider",children:"COORDINATOR"})]}),t.jsxs("div",{className:m("w-full p-4 border rounded-xl backdrop-blur-md transition-all duration-300 cursor-pointer hover:scale-105 group relative overflow-hidden",r.status==="locked"&&"bg-black/40 border-white/5 text-stone-600 grayscale opacity-60",r.status==="open"&&"bg-black/60 border-babel-gold shadow-[0_0_20px_rgba(212,175,55,0.2)]",r.status==="passed"&&"bg-emerald-900/20 border-emerald-500/50 text-emerald-100"),children:[t.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/5 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-1000"}),t.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[t.jsx("div",{className:m("w-8 h-8 rounded-full flex items-center justify-center border",r.status==="open"?"border-babel-gold bg-babel-gold text-black font-bold":"border-white/10 bg-white/5"),children:r.status==="passed"?t.jsx(T,{size:16}):r.index}),t.jsxs("div",{children:[t.jsxs("h4",{className:"font-serif font-bold text-lg",children:["Sequence ",r.index<10?`0${r.index}`:r.index]}),t.jsx("p",{className:"text-[10px] uppercase tracking-widest opacity-70",children:r.status==="locked"?"Access Denied":r.status==="open"?"Ready to Start":"Stabilized"})]})]}),r.status==="open"&&t.jsxs("div",{className:"mt-2 text-xs text-babel-gold flex items-center gap-1 animate-pulse",children:[t.jsx(q,{size:12,fill:"currentColor"})," Click to Synchronize"]})]}),v<h.length-1&&t.jsx("div",{className:m("absolute top-full h-12 w-0.5 bg-white/10",p?"right-8":"left-8","hidden md:block")})]},r.id)})})]}),t.jsx("div",{className:"p-4 text-center text-[10px] text-stone-500 border-t border-white/5 bg-black/80",children:"도서관의 기록을 순서대로 복원하십시오."})]})};export{J as QuestProgressView,J as default};
